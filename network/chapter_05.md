# 무엇을 공부 했는가?

네트워크 5장의 핵심은, 3계층에서 데이터가 수신처까지 도달하는 데에 중점을 두었다면, 
`4계층`에서는 `어플리케이션`이 데이터를 `식별`하는 구조와 `5, 6, 7계층`에서 어플리케이션에 송신할 또는 수신한 `데이터 처리`를 수행하는 구조에 대해서 배우게 된다.

다시 말하자면, 4계층 부터는 데이터를 직접 전송하지 않고 전송한 혹은 전송할 데이터의 처리를 담당한다고 보면 된다.

## 컴퓨터는 여러 요청을 어떻게 구별할까?

데이터를 주고받는 컴퓨터 소프트웨어를 우리는 `어플리케이션` 이라고 정의한다. 각각의 데이터를 주고받는 건 어플리케이션에서 담당한다.

- 어플리케이션은 브라우저, 메일, FTP 서버 처럼 다양하다.
- 어플리케이션의 송신처, 수신처를 결정하기 위해 `포트 번호`가 부여된다.
- localhost:8080 에서의 8080은 여기서 말하는 포트 번호가 맞다.
- 이런 데이터 처리에 대해 제어를 수행하는 프로토콜은 우리가 흔히 알고 있는 `TCP` 와 `UDP` 이다.
- 어플리케이션 간의 데이터 송수신을 위해 미리 확인을 주고 받는 루트를 `커넥션` 이라고 부른다.
- 이 루트를 만들어 내는 것을 `커넥션 확립` 한다고 부른다.
- `TCP 통신`의 특징이란 데이터 송수신에 대한 약속을 확실하게 주고받고 데이터를 보내는 점이다.
- 그러므로, 송신처와 수신처가 존재 할 때 서로 확인요청을 주고받으려면 최소 3번의 말을 주고받아야 한다는 점이다.

```
- 데이터 보낼 건데 준비됐어?
- OK. 거긴 어때?
- 준비 완료.
```

- 이 과정을 `쓰리웨이 핸드쉐이크` 라고 부른다.

## TCP는 데이터를 세그먼트로 캡슐화 한다

- 한 개의 데이터를 `MSS(Max Segment Size)`라는 단위로 분할 한다. 각 세그먼트에 번호를 붙이는데 이 번호를 `시퀀스 번호` 라고 부른다.

- 이 시퀀스 번호는 `보내는 데이터의 옥텟 번호`와 `확인 응답 번호`로 구성이 되어 있는데, 확인 응답 번호는 `다음에 받고 싶은 데이터`의 `선두 옥텟 번호`를 의미한다.

- 그러니까, `다음에 몇 번 부터 데이터를 주세요` 라는 확실한 응답을 보내는 점이다.

## TCP 통신이 효율성을 유지할 수 있는 이유

- 복수의 세그먼트 송신을 하고, 확인 응답을 전송하는 과정은 언뜻 보면 시간이 오래 걸리는 것 같다.

- TCP는 정확한 통신 이외에도, 효율적인 통신을 위해 `윈도우 제어`를 한다.

- 이 때, 수신한 데이터를 일시적으로 보관해두는 `버퍼`를 사용한다.

- 이 버퍼 사이즈를 전해줌으로, 송신할 수 있는 데이터 양을 알려주는데 이로부터 데이터 `오버플로`를 막는다.

- 버퍼량을 `윈도우 사이즈`라고 부르고, 이 윈도우 사이즈를 전달해서 확실하게 수신할 용량의 데이터만 송수신 하는 걸 윈도우 제어라고 부르는 것.

## UDP는 포트 번호만 알아두자

- 포트 번호만 존재한다는 건 무엇을 의미할까?
- 확인 과정을 거치지도 않고, 대기시간을 필요로 하지 않는다.
- 이 말은 전송 효율이 떨어지지 않는 프로토콜 이라는 점이다.
- UDP의 최대 특징은 고속으로 데이터를 어플리케이션에 전송한다.
- 고속이면 생각나는 키워드가 있다. `실시간`, `스트리밍`..

- TCP 에서는 커넥션을 확립 했지만, UDP는 필요하지 않다.
- 이 말은, 수신처가 따로 필요하지 않은 브로드캐스트 통신이 필요한 어플리케이션도 UDP를 사용할 수 있다는 말이다.

## 사설 IP 주소의 부족을 해결하기 위해 도입 된 것들 

주 해결 방법은 클래스리스 어드레싱을 활용해서 문제를 해결하는 데 존재한다.


- `NAT` 테이블은 글로벌 IP 주소와 호스트 주소가 매핑 되어 있다.
- 이것 만으로도 부족해서 나온 것이 `NAPT`.
- 그렇다, 포트 번호까지 변환해서 접속 중인 복수의 기기까지 구별할 수 있도록 한 것이다.
- 수신처가 변환되어 있지 않은 포트 번호 수신이 가장 큰 특징인데, NAPT 테이블에 매핑이 되어있지 않은 주소라면, 내부 네트워크로 들어올 수 없다.

## 5, 6, 7계층

- 수 많은 커넥션을 통해 데이터를 주고 받기 위해서는  이 커넥션을 하나의 대화로 묶는다 이 과정을 `세션`이라고 부른다.

- 이 `세션`에서 대화가 성립 하도록 제어하는 걸 `다이얼로그 제어` 라고 부른다.

- 데이터를 보낼 차례, 받을 차례를 정한다는 것이다.

- 표현계층인 `6계층` 에서는 `데이터 형식`을 결정한다.

- 문자 변환, 파일의 형식 변환은 모두 6계층에서 이루어 지는 것.

- 그럼 7계층은? 7계층은 네트워크를 통해 데이터를 전달하는 계층의 출발지 이므로, 어플리케이션을 위해 준비하는 계층이다.

